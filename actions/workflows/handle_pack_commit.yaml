---
version: '2.0'

bitovi_packs.handle_pack_commit:
  input:
    - trigger_payload

  tasks:

    extract_path:
      action: "core.noop"
      publish:
        path: <% $.trigger_payload['file_path'].split('/').splitAt(5)[0].join('/') %>
      on-success:
        - install_pack

    install_pack:
      action: "bitovi_packs.install"
      input:
        packs: "file:///{{ _.path }}"